---
# title: "The document title"
output:
  bookdown::pdf_document2:
    toc: false
    includes:
      in_header: "preamble.tex"
    latex_engine: lualatex
  word_document:
    reference_docx: style_reference.docx
always_allow_html: true
bibliography: bibliography.bib
csl: nlm.csl
---

```{r, setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE, results = "hide", message = FALSE, warning = FALSE
)
```

```{r source}
library(here)
library(broman)
library(kableExtra)
source(here("code", "02_explore.R"))
```

<!--
\begin{center}
Lucas Veras$^1$, Florêncio Diniz-Sousa$^1$, Giorjines Boppre$^1$, Vítor Devezas$^2$, Hugo Santos-Sousa$^2$, John Preto$^2$, João Paulo Vilas-Boas$^{3,4}$, Leandro Machado$^{3,4}$, José Oliveira$^1$, Hélder Fonseca$^1$
\end{center}

\bigskip

1 - Research Center in Physical Activity, Health and Leisure (CIAFEL), Faculty of Sport, University of Porto, Porto, Portugal

2 - General Surgery Department, São João Medical Center, Porto, Portugal

3 - Center of Research, Education, Innovation and Intervention in Sport (CIFI2D), Faculty of Sport, University of Porto, Porto, Portugal

4 - Biomechanics Laboratory (LABIOMEP-UP), University of Porto, Porto, Portugal
-->

# Introduction {.unnumbered}

Exercise-related mechanical loading plays a key role in bone health, by promoting positive effects on bone mass, geometry and microarchitecture [@Turner2003; @Fonseca2014]. However, not all forms of mechanical stimulation are equally osteogenic, and the manipulation of variables such as loading magnitude, rate, frequency and volume can produce different bone responses [@Turner1998; @Turner2003]. Therefore, the correct assessment of mechanical loading, specially in a clinical environment, is of paramount importance to attain a significant positive bone response to exercise. Nonetheless, a limitation in this context is that the mechanical loading evaluation is usually performed only by instruments restrained to laboratory settings.

\medskip

Force plates (FP) are the golden standard instrument for mechanical loading measurement [@Medved2000]. However, their cost, need of expertise to collect and analyze data, of a dedicated indoor space and ongoing calibration and maintenance hinders its application in clinical settings. Accelerometers, due to their portability, low-cost and accuracy, are widely used to objectively measure physical activity related to cardiometabolic outcomes [@Troiano2014; @Migueles2017], and, more recently, have been proposed as adequate devices to predict gravitational loading variables [@Neugebauer2012; @Fortune2014; @Neugebauer2014; @Neugebauer2018; @Veras2020]. Given the need to assess mechanical loading in clincal settings in order to control and monitor exercise prescription for bone health, accurate mechanical loading prediction models need to be developed and validated for the most common activities prescribed to induce bone adaptations, such as walking, running, and jumping. These models, apart from being accurate, need to be transparent in their data processing methods, allowing replicability of the results, and ideally offer a tool to facilitate data processing and analysis for those who are not familiar with the employed techniques, such as what is already offered for analysing cardiometabolic variables [@Migueles2019], and thus spread their applicability.

\medskip

The ground reaction force (GRF) is arguably the most studied mechanical loading variable, and its relationship with the bone adaptations to exercise is well established [@Turner2003; @Rantalainen2008; @Rantalainen2009]. Due to its importance, some studies have already attempted to develop peak GRF (pGRF) prediction equations based on accelerometry data in several populations, such as children [@Neugebauer2012], adults [@Fortune2014; @Neugebauer2014], patients with obesity [@Veras2020] and military [@Neugebauer2018], but with the majority of these studies including only activities with eliciting a low loading magnitude. Besides loading magnitude, loading rate (LR) is another variable related with bone health [@Rowlands2014] that could potentially be predicted by accelerometer data, but with apparently lower prediction accuracy compared with pGRF [@Fortune2014; @Veras2020]. Also, to the best of our knowledge, peak LR (pLR) prediction through accelerometer data has only been tested during walking.

\medskip

Therefore, given the necessity of an accurate and reliable method to assess mechanical loading in clinical settings in order to better monitor and prescribe exercise to obtain positive bone health outcomes, the aim of this study was to develop pGRF and pLR prediction models based on accelerometer data during walking and running.

# Methods {.unnumbered}

## Participants {.unnumbered}

A convenience sample of `r max(sample_size$pGRF_N)` adults (`r unname(sample_size_sex["M"])` males; `r sample_descriptives$age_mean`±`r sample_descriptives$age_sd` years; `r sample_descriptives$height_mean`±`r sample_descriptives$height_sd` cm; `r sample_descriptives$body_mass_mean`±`r sample_descriptives$body_mass_sd` kg; `r sample_descriptives$BMI_mean`±`r sample_descriptives$BMI_sd` kg·m^-2^, X̄±SD) with no self-reported neurological or musculoskeletal limitations was recruited. Height and body mass were assessed following standard procedures with a stadiometer and a digital scale, respectively. All participants were informed about the experiments purpose and protocol before giving written informed consent. The study was approved by the local Ethics Committee (CES 192-14).

## Protocol {.unnumbered}

Data collection took place at Porto Biomechanics Laboratory (LABIOMEP-UP) on an instrumented treadmill with built-in FP (AMTI Corporation, Watertown, USA). Before starting the data collection, participants were given time to warm up on the treadmill. The protocol consisted of walking and running in 13 incremental speeds, with 0º inclination, from 2 to 14 km·h^-1^ with 1 km·h^-1^ increment. Walking and running speeds ranged from 2 to 6 km·h^-1^ and from 7 to 14 km·h^-1^, respectively. Each walking speed lasted 1 minute and each running speed 30 seconds. To ensure single foot contact on each FP during the trial, feedback regarding location on the treadmill was provided by a researcher. Participants wore their own sports shoes throughout the trials.

\medskip

During the protocol, participants wore three activity monitors, one at their right hip (along the anterior axillary line, at the level of the iliac crest), another at their lower back (at the midpoint between the two posterior superior iliac spines) and the last at their right ankle (immediately superior to the lateral malleolus). Activity monitors at waist level were secured on the same elastic belt with a clip and the activity monitor placed on the ankle was secured by an elastic belt fixed with adhesive tape. In all placements the accelerometer vertical axis was aligned with the standing body longitudinal axis. All participants wore the same three activity monitors always positioned at the same places.

\medskip

Activity monitors used were the GT9X Link model (±16*g* range; ActiGraph, Pensacola, USA) that incorporates primary and secondary triaxial accelerometers. As a manufacturer proprietary filter is applied on the primary, but not on the secondary accelerometer raw data, and therefore only data from the latter was used in this study, reducing filtering bias and enhancing the data processing replicability.

\medskip

Data from FP and accelerometers were collected at 1000 Hz and 100 Hz sampling frequency, respectively, and operated through the manufacturer supplied software (for the FP: Netforce, Version 3.5.1; AMTI Corporation, Watertown, USA; for the accelerometers: ActiLife version 6.13.3; Actigraph, Pensacola, USA). Raw GRF (expressed in N) and ACC (expressed in gravitational ACC units; 1*g* = 9.807 m·s^-2^) from the x, y and z vectors were exported to plain text files.

## Data processing {.unnumbered}

FP and accelerometer data were processed using MATLAB (Version 2019a, Mathworks, Natick, USA), as described elsewhere [@Veras2020]. Briefly, both GRF and acceleration (ACC signals were filtered using a Butterworth fourth-order low-pass filter, with 20 Hz cut-off frequency, and their resultant vector calculated ($r_i = \sqrt{x_i^2 + y_i^2 + z_i^2}$). After that, peak ACC (pACC) values were defined as minimum height of twice the positive ACC average, during any given speed, and separated by 0.4 seconds minimum. GRF and ACC signals were adjusted through the time set by the systems clock, with manual correction based on visual inspection for possible errors, and then synchronized by the maximum cross-correlation coefficient. Peak GRF (pGRF) was determined as the highest value between 0.4 seconds before and after each pACC. The rates of change, LR for the GRF and ACC rate (AR) for the ACC, were computed through a centered derivative from the beginning of the foot contact to the pGRF. The pLR and peak AR (pAR) were defined as the maximum value in the array.

\[f_i^{'} = \frac{f_{i + 1} - f_{i - 1}}{t_{i + 1} - t_{i - 1}}\]

\[f_{i_{max}}^{'} = max(f_i^{'})\]

Regions of interest for data analysis were manually selected where locomotion patterns were constant, which corresponded of 20-45 seconds periods, on average. Then, pGRF, pACC, pLR and pAR means of the resultant and its vertical component for each participant at each speed were extracted and used in all remaining analyses. In walking trials, a median of `r n_peaks_desc[which(n_peaks_desc$locomotion_type == "walking"), "n_peaks_median"]` peaks (interquartile range `r n_peaks_desc[which(n_peaks_desc$locomotion_type == "walking"), "n_peaks_median"] - n_peaks_desc[which(n_peaks_desc$locomotion_type == "walking"), "n_peaks_iqr"]`\textendash`r n_peaks_desc[which(n_peaks_desc$locomotion_type == "walking"), "n_peaks_median"] + n_peaks_desc[which(n_peaks_desc$locomotion_type == "walking"), "n_peaks_iqr"]`) were used to calculate these means, while in running trials it was a median of `r n_peaks_desc[which(n_peaks_desc$locomotion_type == "running"), "n_peaks_median"]` peaks (interquartile range `r n_peaks_desc[which(n_peaks_desc$locomotion_type == "running"), "n_peaks_median"] - n_peaks_desc[which(n_peaks_desc$locomotion_type == "running"), "n_peaks_iqr"]`\textendash`r n_peaks_desc[which(n_peaks_desc$locomotion_type == "running"), "n_peaks_median"] + n_peaks_desc[which(n_peaks_desc$locomotion_type == "running"), "n_peaks_iqr"]`).

## Statistical analyses {.unnumbered}

Statistical analyses were conducted using R statistical software (version `r paste(R.Version()$major, R.Version()$minor, sep = ".")`, R Foundation for Statistical Computing, Vienna, Austria). All statistical analyses were registered in an open platform, where R code utilized and detailed information can be assessed (LINK). The statistically significant value was set as $\alpha$ = 0.05.

\medskip

Regression equations to predict pGFR and pLR in each vector (resultant and vertical) for each accelerometer placement (ankle, lower back and hip) were developed by linear mixed models. Body mass (kg) was tested as a predictor in all models. Additionally, pACC and pAR were tested as predictors in the pGRF and pLR models, respectively. All predictors were tested as fixed effects and were shown to be significant. Subject and speed were tested as random effects, and the inclusion of both has showed to improve the models. Final models were chosen according to -2 log-likelihood statistics [@Field2012]. Traditional coefficient of determination (R^2^) was represented by conditional R^2^, that estimates the variance explained by the whole model [@Nakagawa2013].

\medskip

Models were validated using the leave-one-out cross-validation approach [@Staudenmayer2012]. For this, each participant’s data were separated into a testing dataset (one participant at a time) with the remaining data in the training dataset. New linear mixed models with the same outcomes and predictors as determined for the entire sample were developed using the training dataset and then used to predict the outcome for the participant in the testing dataset. This process was repeated for all participants (`r max(sample_size$pGRF_N)` times). Data from the testing dataset was used in the remaining statistical analysis.

\medskip

To assess the models prediction accuracy, mean absolute error (MAE), mean absolute percent error (MAPE) and root mean square error (RMSE) were calculated. Although there is no standard threshold defining an acceptable error for mechanical loading prediction, based on previous studies we considered a MAPE <8\% to be an accurate prediction [@Fortune2014; @Neugebauer2014; @Ancillao2018]. Also, methods agreement was evaluated with Bland-Altman plots by plotting the difference between the actual (FP measured) and predicted values against their mean. Bias was computed as the mean of these differences and the limits of agreement were obtained using ±1.96 standard deviation of the mean between actual and predicted values [@Bland1986]. In order to test whether there was a consistent over or underestimation of the actual values, one-sample *t* tests were performed to assess if the difference between actual and predicted values are different than zero. Linear regressions were applied to identify if the magnitude of the mean between actual and predicted values influenced the magnitude of their difference. This was done to ascertain if the prediction accuracy was constant throughout the assayed magnitude range, which is known as proportional bias [@Giavarina2015]. These analyses were conducted separately for data from each accelerometer placement and outcome.

\medskip

Finally, our pGRF prediction equation was compared with a previously published reference equation [@Neugebauer2014], that was developed using similar methods. This comparison was performed in three ways using: i) the whole sample; ii) a subsample of walking trials; iii) a subsample of running trials. To assess the prediction accuracy, MAE, MAPE and RMSE were calculated using pGRF values predicted from both equations. No pLR prediction equation suited to be compared with ours was found.

\medskip

# Results {.unnumbered}

Our recruited sample presented a broad range of body masses, from normal weight to severe obesity. It would be expected that participants with higher body mass index (BMI) values, due to low motor ability and physical capacity, are able to perform the trials only at the lowest speeds. This was precisely what happened and, as can be observed in Figure 1, from 2 to 5 km·h^-1^ the BMI median was around 30 kg·m^-2^, decreasing to around 27 kg·m^-2^ at 6 km·h^-1^, which was the fastest walking speed, with a further reduction to less than 25 kg·m^-2^ at the running speeds. Furthermore, only one participant with a BMI higher than 30 kg·m^-2^ was able to run. This implies in a sample size reduction from `r filter(sample_size, acc_placement == "hip" & vector == "resultant" & speed == "2")$pGRF_N` at the slowest speed to `r filter(sample_size, acc_placement == "hip" & vector == "resultant" & speed == "14")$pGRF_N` at the fastest.

\begin{figure}[ht]
	\captionsetup{singlelinecheck = false, format = hang, justification = raggedright, font = footnotesize, labelsep = space}
	\centering
	\begin{measuredfigure}
		\includegraphics[width=\textwidth]{fig1.png}
		\caption{Distribution of participant’s body mass index per speed. Dots represent individual participants.}
	\end{measuredfigure}
\end{figure}

\medskip

As the main variables collected in this experiment are the peak magnitudes and rates of the GRF and ACC signals, there was a need to first establish their relationship. During locomotion, pACC increases linearly as pGRF increases. Such relation can be observed in the Figure 2, Panel A, for from hip-worn accelerometers and the resultant vector, and in Supplemental Figure S1 for all placements and the resultant vector and its vertical component. Moreover, for the same pACC values, the registered pGRF tended to be higher in subjects with higher BMI. It demonstrates that accelerometer data can adequately discriminate between different BMI categories. However, data from the pAR x pLR relationship show a greater dispersion, especially at higher values, and the different BMI categories cannot be discriminated so well, as can be observed in Figure 2, Panel B, and Supplemental Figure S2.

\begin{figure}[ht]
	\captionsetup{singlelinecheck = false, format = hang, justification = raggedright, font = footnotesize, labelsep = space}
	\centering
	\begin{measuredfigure}
		\includegraphics[width=\textwidth]{fig2.png}
		\caption{Relationship between variables collected by force plates and accelerometers worn at hip, for the resultant vector. Linear trends for each body mass index category are also depicted. Panel A shows peak magnitudes (pGRF and pACC) while Panel B shows peak rates (pLR and pAR). Abbreviations: pACC, peak acceleration; pAR, peak acceleration rate; pGRF, peak ground reaction force; pLR, peak loading rate.}
	\end{measuredfigure}
\end{figure}

\medskip

```{r GRF_accuracy}
load(here("output", "prediction_models.rda"))
res_GRF_accuracy <- purrr::map(
  accuracy_res_GRF_models,
  ~ dplyr::mutate(.x, MAPE = as.numeric(MAPE))
) %>%
  purrr::map_dfr(rbind) %>%
  dplyr::mutate(
    placement = c("ankle", "lower back", "hip"),
    vector = "resultant"
  )
ver_GRF_accuracy <- purrr::map(
  accuracy_ver_GRF_models,
  ~ dplyr::mutate(.x, MAPE = as.numeric(MAPE))
) %>%
  purrr::map_dfr(rbind) %>%
  dplyr::mutate(
    placement = c("ankle", "lower back", "hip"),
    vector = "vertical"
  )
GRF_accuracy <- rbind(res_GRF_accuracy, ver_GRF_accuracy)
hip_GRF_accuracy <- GRF_accuracy %>%
  filter(placement == "hip" & vector == "resultant")
```

Regression equations were developed to predict the mechanical loading variables based on accelerometry data. In the pGRF prediction equations, body mass and pACC were significant predictors and included in the models. Table 1 shows the regression coefficients, R^2^ and accuracy indices from models derived from accelerometers placed at ankle, lower back and hip, and from the resultant vector and its vertical component. In all pGRF prediction models, R^2^ values were `r max(GRF_accuracy$R2_cond)`, which shows that the predictor variables are able to explain the variability in the outcome variable to a great extent. Also, MAE ranged between `r myround(min(GRF_accuracy$MAE), 1)` N and `r myround(max(GRF_accuracy$MAE), 1)` N, and the MAPE from `r myround(min(GRF_accuracy$MAPE) * 100, 1)`\% to `r myround(max(GRF_accuracy$MAPE) * 100, 1)`\%, which is a smaller error than previously published equations [@Neugebauer2014; @Fortune2014], and similar to the error from equations previously published by our group, but which included walking only [@Veras2020]. RMSE were also computed and shown to range between `r myround(min(GRF_accuracy$RMSE), 1)` N and `r myround(max(GRF_accuracy$RMSE), 1)` N. Of all the pGRF predictions equations developed, the one based on hip-worn accelerometers and the resultant vector has shown the best performance, with an R^2^ of `r hip_GRF_accuracy$R2_cond`, and the lowest MAE (`r myround(hip_GRF_accuracy$MAE, 1)` N), MAPE (`r myround(hip_GRF_accuracy$MAPE * 100, 1)`\%) and RMSE (`r myround(hip_GRF_accuracy$RMSE, 1)` N).

\medskip

```{r LR_accuracy}
load(here("output", "prediction_models.rda"))
res_LR_accuracy <- purrr::map(
  accuracy_res_LR_models,
  ~ dplyr::mutate(.x, MAPE = as.numeric(MAPE))
) %>%
  purrr::map_dfr(rbind) %>%
  dplyr::mutate(
    placement = c("ankle", "lower back", "hip"),
    vector = "resultant"
  )
ver_LR_accuracy <- purrr::map(
  accuracy_ver_LR_models,
  ~ dplyr::mutate(.x, MAPE = as.numeric(MAPE))
) %>%
  purrr::map_dfr(rbind) %>%
  dplyr::mutate(
    placement = c("ankle", "lower back", "hip"),
    vector = "vertical"
  )
LR_accuracy <- rbind(res_LR_accuracy, ver_LR_accuracy)
back_LR_accuracy <- LR_accuracy %>%
  filter(placement == "lower back" & vector == "resultant")
```

Moreover, pLR prediction equations were developed, and these included as predictors the pAR and again body mass. Regression coefficients, R^2^ and accuracy indices for these equations are also shown in Table 1. For these equations, the lowest R^2^ found was `r myround(min(LR_accuracy$R2_cond), 2)` and the highest was `r myround(max(LR_accuracy$R2_cond), 2)`, reflecting a moderate to high prediction ability. MAE, MAPE and RMSE values ranged from `r myround(min(LR_accuracy$MAE), 1)` N to `r myround(max(LR_accuracy$MAE), 1)` N, from `r myround(min(LR_accuracy$MAPE) * 100, 1)`\% to `r myround(max(LR_accuracy$MAPE) * 100, 1)`\%, and from `r myround(min(LR_accuracy$RMSE), 1)` N to `r myround(max(LR_accuracy$RMSE), 1)` N, respectively. The results found for the pLR prediction equations were all considerably poorer than those for the pGRF equations. The accuracy indices values were also somewhat worse than previously published pLR prediction equations [@Veras2020; @Fortune2014], although equations from both studies were only validate for walking. The pLR equation with the lower prediction error was the one for accelerometers worn at lower back and the resultant vector, with an R^2^ of `r back_LR_accuracy$R2_cond` and a MAE, MAPE and RMSE of `r myround(back_LR_accuracy$MAE, 1)` N, `r myround(back_LR_accuracy$MAPE * 100, 1)`\% and `r myround(back_LR_accuracy$RMSE, 1)` N, respectively.

\medskip

```{r accuracy_table, results = "show"}
source(here("tables", "tab1.R"))
tab1
```

```{r ba_regression}
source(here("code", "04_sub_analyses.R"))
ba_regression_ankle_R2 <- c(
  ba_regression_res_GRF$ankle["adj.r.squared"],
  ba_regression_ver_GRF$ankle["adj.r.squared"],
  ba_regression_res_LR$ankle["adj.r.squared"],
  ba_regression_ver_LR$ankle["adj.r.squared"]
) %>%
  as_vector()
```

Afterwards, Bland-Altman plots were built to visualize the agreement between the actual and predicted pGRF and pLR, for both the resultant vector and its vertical component from all accelerometer placements. Bland-Altman plots for the pGRF and pLR resultant vector from hip-worn accelerometers can be seen in Figure 3, and for all accelerometer placements and both resultant and vertical vectors in the Supplemental Figures S3 and S4. Values for all pGRF and pLR prediction equations developed tended to assemble around zero and between the limits of agreement. For the pGRF equations, a tendency to higher dispersion can be observed in the higher magnitudes, which correspond to the running trials, and especially in values derived from ankle-worn accelerometers (Supplemental Figure S3, Panels A and D). Prediction equations for pLR showed a more accentuated dispersion, and again mainly in the higher magnitudes (Supplemental Figure S4). The pLR prediction model based on data from accelerometers placed at the ankle and the resultant vector displayed a bias different than zero (*p* = `r myround(ba_bias_test_res_LR$ankle["p.value"], 2)`). None of the other models presented a bias different than zero (*p* > 0.05), demonstrating that they do not consistently over or underestimate the pGRF and pLR values. All equations based on ankle-worn accelerometer data, for both outcomes (pGRF and pLR) and vectors (resultant and vertical) showed a significant proportional bias (*p* < 0.05). Despite the statistical significance, linear regressions presented a low R^2^ (highest R^2^ = `r myround(max(ba_regression_ankle_R2), 2)`).

\begin{figure}[ht]
	\captionsetup{singlelinecheck = false, format = hang, justification = raggedright, font = footnotesize, labelsep = space}
	\centering
	\begin{measuredfigure}
		\includegraphics[width=\textwidth]{fig3.png}
		\caption{Bland-Altman plots showing agreement between actual and predicted peak ground reaction force (Panel A) and loading rate (Panel B) for the resultant vector from hip-worn accelerometers. Continuous thick lines show bias (average of the differences between actual and predicted values) while dashed lines show the limits of agreement (bias \pm 1.96 standard deviation). Abbreviations: pGRF, peak ground reaction force; pLR, peak loading rate.}
	\end{measuredfigure}
\end{figure}

\medskip

Furthermore, we compared the performance of our equations with a reference equation previously published. As the only comparable equation found was the one to predict pGRF vertical vector using hip-worn accelerometer data developed by Neugebauer et al [@Neugebauer2014], we applied it to our data and computed the MAE, MAPE and RMSE. Then, these indices were compared to the indices for our equation (Table 1). Apart from the overall equations performance, it was done a sub-analysis separating the walking and running trials. The results of these comparisons can be observed in the Table 2. Accuracy indices of our equations were all better compared to the reference equation, with a MAPE approximately 2 to 3 times lower. Furthermore, our equation performance was constant between walking and running, indicating that it can be used for both activities without loss of accuracy, which cannot be observed in the reference equation.

```{r comparison_table, results = "show"}
source(here("tables", "tab2.R"))
tab2
```

Also, to simplify the use of these equations and enhance their applicability, a software package was developed for the use in the R statistical software (REF). Included in this package are functionalities to read raw ACC data, process it and apply the equations to predict both pGRF and pLR. In the package website (ADDRESS) there are instructions on how to use it to obtain the predictions, namely in the 'Home' and 'Get started' sections.

# Discussion {.unnumbered}

The purpose of this study was to develop pGRF and pLR prediction equations based on accelerometer data able to accurately estimate the mechanical loading during walking and running. The predictions were tested with accelerometers placed at different body locations and using both the resultant vector and its vertical component in a set of incremental speeds, ranging from slow walking to running. Our findings demonstrated that accelerometer-based regression models were a valid and accurate method to estimate pGRF during human locomotion, as all of the pGRF prediction models developed presented a MAPE below the 8\% threshold established by us. However, accelerometry-based equations developed to predict pLR did not yield trustworthy results.

\medskip

Comparing our results with previous studies that used a similar approach to predict pGRF, it can be seen that prediction errors from our models are comparable with some studies whose best results presented a MAPE of approximately 6.0\% but which included only walking in their protocol [@Fortune2014; @Neugebauer2018; @Veras2020]. Additionally, previous studies that developed pGRF prediction models during both walking and running showed a MAPE of 8.3\% [@Neugebauer2012] and 5.2\% [@Neugebauer2014], which are higher or similar to our results, respectively. Nevertheless, models from both studies present a caveat, that is the inclusion of a term in their equations that distinguishes whether the activity is walking or running, which is not easy to be identify from free-living accelerometer data, hindering the application of these equations. Also, one of these studies included in the sample only children and adolescents [@Neugebauer2012]. It is important to mention that the prediction error found in our pGRF models is lower than the error typically found in models developed to estimate energy expenditure [@Diniz-Sousa2020], which is one of the main uses of accelerometer data [@Migueles2017].

\medskip

Our findings revealed that either ankle, lower back and hip were valid accelerometer placements to accurately predict pGRF. However, despite the similarities, hip was the accelerometer placement with the best prediction accuracy, which reinforces it as the preferable location to collect and analyse accelerometry-measured physical activity data. This placement is already well accepted for energy expenditure prediction and physical activity intensity classification [@Migueles2017] and has also shown a high mechanical loading prediction ability in previous studies [@Veras2020; @Neugebauer2018; @Neugebauer2012]. Besides the various placements, the current study also analysed predictions from both the resultant and vertical vectors. Although ACC and GRF from the vertical vector are the most studied and frequently associated with bone health [@Vainionpaa2006; @Heikkinen2007], the resultant vector of both ACC and GRF during locomotion is greatly determined by the vertical vector, and, as can be observed in Supplemental Figure S1, values from both vectors in this study were very similar. Also, mechanical loading prediction based on the resultant ACC offers the important advantage of not being dependent on the accelerometer correct orientation, which is hard to assure when measuring daily physical activity [@Welk2005; @Wundersitz2015].

\medskip

To the best of our knowledge, only two studies have already attempted to develop pLR prediction models based on accelerometry data, and both studies only included walking activities. Accordingly to what we found, these studies also showed that the prediction error for these models is considerably larger than for the pGRF prediction. One of these researches investigated the use of four different accelerometer placements (ankle, tibia, thigh and waist) to predict pLR and achieved a MAPE ranging from 23.4\% to 46.1\% [@Fortune2014], the other one found values from 19.5\% to 22.4\% using accelerometers at the lower back and hip [@Veras2020]. Results from the models developed in both these investigations ranged from lower to higher prediction error compared to our results, which are approximately of 29.0\%. Although pLR is an important variable, known for a long time to affect the bone response to mechanical loading [@Bassey1998; @Turner1995], based on this and previous studies [@Fortune2014; @Veras2020], its prediction through accelerometer data does not seem to yield trustworthy results. Nevertheless, past research has suggested that the bone response to pGRF and pLR is somewhat similar due to the high correlation between these variables [@Heikkinen2007]. Therefore, the pGRF prediction by accelerometry data, which is shown to be accurate, already incorporates some of the LR effect on the bone response to loading.

\medskip

Results from our study offer some advantages compared to previous investigations: i) it includes walking and running, which are among the most usual types of physical activity performed daily; ii) all models developed, especially for pGRF prediction, presented a similar or better accuracy compared to the results from previous publications; iii) the accuracy of our models is constant throughout walking and running, and therefore they can be used adequately for both activities; iv) in order to apply our models there is no need to distinguish the accelerometer data between walking and running, which facilitates its use with daily living accelerometer data; and v) along with the creation of these models, a software was developed in the form of an R package to perform all the computations needed to get from the raw accelerometer data to the mechanical loading prediction.

\medskip

Besides these advantages, our models present some important potential clinical applications. For instance, these models can be used to analyse data from large observational studies and make associations between mechanical loading and bone health. But instead of analysing accelerometer data averaged in epochs similarly to some previous publications [@Chastin2014; @Stiles2017], which can dilute the higher intensities [@Fabre2020], with our method raw ACC can be analysed at a higher resolution by identifying the pGRF associated with each step taken and establishing, for example, the number of peaks above certain magnitude needed to elicit a positive bone adaptation. Another potential application could be the computation of the cumulative mechanical loading by adding up the pGRF of all detected steps. This information could be used either for the determination of the relationship between the mechanical loading accumulated in a certain period (e.g., a day) and the bone response to this loading [@Ahola2010], or also in sports training, by monitoring the amount of loading beared by athletes and relate to the osteoarticular safety of the training regimen [@Vanwanseele2020].

\medskip

Despite the validity of the prediction models developed here, some limitations should be mentioned. First, although the activities included in our protocol (walking and running) are among the most performed during daily living, our prediction models are not applicable to other activities known to influence the bone adaptation to mechanical stimuli, such as jumping and direction changing. Second, in the absence of another sample for model validation, the leave-one-out cross-validation method was used, which is the method of choice in these situations [@Staudenmayer2012]. Nevertheless, future studies should test the out-of-sample validity of these models. Lastly, the protocol was performed on an instrumented treadmill. The use of a treadmill, although enhancing the study internal validity by the continuously measuring the GRF [@Ngoh2018] also reduces the external validity due to possible biomechanical changes in the walking and running patterns induced by the treadmill [@Kluitenberg2012].

\medskip

In conclusion, pGRF could be accurately predicted by accelerometry-based regression models. These models are valid for the use of both the resultant vector and its vertical component, and using data from accelerometers placed at either the ankle, lower back or hip. The prediction models developed in this study have proved to be an efficient method to assess pGRF out of laboratory conditions, with potential applications of monitoring the mechanical loading in several contexts and establishing the relationship of this loading and either a positive or negative osteoarticular adaptation. This is also the first work, to the best of our knowledge, to explore the prediction of pLR based on accelerometry data during both walking and running, although the accuracy of these models were unsatisfactory.

\newpage

# References {.unnumbered}

<div id="refs"></div>

\newpage

# Supplemental Material {.unnumbered}

## Supplemental Figure S1 {.unnumbered}
\begin{figure}[ht]
	\captionsetup{singlelinecheck = false, format = hang, justification = raggedright, font = footnotesize, labelsep = space}
	\centering
	\begin{measuredfigure}
		\includegraphics[width=\textwidth]{figS1.png}
	\end{measuredfigure}
\end{figure}
\footnotesize Relationship between peak ground reaction force and acceleration magnitudes. Data from accelerometers worn at ankle (Panels A and D), lower back (Panels B and E) and hip (Panels C and F), for both the resultant vector (Panels A to C) and its vertical component (Panels D to F). Linear trends for each body mass index category are also depicted. Abbreviations: pACC, peak acceleration; pGRF, peak ground reaction force.

\medskip

## Supplemental Figure S2 {.unnumbered}
\begin{figure}[ht]
	\captionsetup{singlelinecheck = false, format = hang, justification = raggedright, font = footnotesize, labelsep = space}
	\centering
	\begin{measuredfigure}
		\includegraphics[width=\textwidth]{figS2.png}
	\end{measuredfigure}
\end{figure}
\footnotesize Relationship between peak loading and acceleration rates. Data from accelerometers worn at ankle (Panels A and D), lower back (Panels B and E) and hip (Panels C and F), for both the resultant vector (Panels A to C) and its vertical component (Panels D to F). Linear trends for each body mass index category are also depicted. Abbreviations: pAR, peak acceleration rate; pLR, peak loading rate.

\newpage

## Supplemental Figure S3 {.unnumbered}
\begin{figure}[ht]
	\captionsetup{singlelinecheck = false, format = hang, justification = raggedright, font = footnotesize, labelsep = space}
	\centering
	\begin{measuredfigure}
		\includegraphics[width=\textwidth]{figS3.png}
	\end{measuredfigure}
\end{figure}
\footnotesize Bland-Altman plots showing agreement between actual and predicted peak ground reaction force for accelerometers worn at ankle (Panels A and D), lower back (Panels B and E) and hip (Panels C and F), for both the resultant vector (Panels A to C) and its vertical component (Panels D to F). Continuous thick lines show bias (average of the differences between actual and predicted values) while dashed lines show the limits of agreement (bias \pm 1.96 standard deviation). Abbreviations: pGRF, peak ground reaction force.

## Supplemental Figure S4 {.unnumbered}
\begin{figure}[ht]
	\captionsetup{singlelinecheck = false, format = hang, justification = raggedright, font = footnotesize, labelsep = space}
	\centering
	\begin{measuredfigure}
		\includegraphics[width=\textwidth]{figS4.png}
	\end{measuredfigure}
\end{figure}
\footnotesize Bland-Altman plots showing agreement between actual and predicted peak loading rate for accelerometers worn at ankle (Panels A and D), lower back (Panels B and E) and hip (Panels C and F), for both the resultant vector (Panels A to C) and its vertical component (Panels D to F). Continuous thick lines show bias (average of the differences between actual and predicted values) while dashed lines show the limits of agreement (bias \pm 1.96 standard deviation). Abbreviations: pLR, peak loading rate.
